generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Assessment {
  idAssessment    Int      @id @default(autoincrement())
  idUser          Int
  tinggiBadan     Int      @db.SmallInt
  beratBadan      Int      @db.SmallInt
  aktivitasHarian String
  faktor          String
  karbohidrat     Int      @default(0) @db.SmallInt
  protein         Int      @default(0) @db.SmallInt
  lemak           Int      @default(0) @db.SmallInt
  created_at      DateTime @default(now()) @db.Date
  updated_at      DateTime @default(now()) @db.Date
  user            User     @relation(fields: [idUser], references: [idUser], onDelete: Cascade)

  @@index([idAssessment, idUser], map: "assessment_index")
  @@index([idUser], map: "Assessment_idUser_fkey")
}

model User {
  idUser           Int              @id @default(autoincrement())
  email            String           @unique
  password         String
  namaLengkap      String
  tanggalLahir     DateTime?        @db.Date
  tanggalKehamilan DateTime?        @db.Date
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @default(now())
  assessments      Assessment[]
  imageNutritions  ImageNutrition[]

  @@index([idUser], map: "users_index")
}

model FoodStorage {
  id          Int              @id @default(autoincrement())
  namaMakanan String           @db.Text
  karbohidrat Int              @default(0) @db.SmallInt
  lemak       Int              @default(0) @db.SmallInt
  protein     Int              @default(0) @db.SmallInt
  createdAt   DateTime         @default(now()) @db.Date
  makanans    ImageNutrition[]

  @@index([id], map: "foodstorage_index")
}

model ImageNutrition {
  id         Int         @id @default(autoincrement())
  idUser     Int
  idMakanan  Int
  gambar     String      @default("") @db.Text
  waktuMakan WaktuMakan
  updated_at DateTime    @default(now()) @db.Date
  created_at DateTime    @default(now()) @db.Date
  makanan    FoodStorage @relation(fields: [idMakanan], references: [id], onDelete: Cascade)
  user       User        @relation(fields: [idUser], references: [idUser], onDelete: Cascade)

  @@index([idMakanan], map: "ImageNutrition_idMakanan_fkey")
  @@index([idUser], map: "ImageNutrition_idUser_fkey")
}

enum WaktuMakan {
  Pagi
  Siang
  Malam
}
